/*
 * qure.js [v0.2.9]
 * https://github.com/hbi99/QureJS.js 
 * Copyright (c) 2013-2015, Hakan Bilgin <hbi@longscript.com> 
 * Licensed under the MIT License
 */
!function(e,t){"use strict";function s(e,t){this._methods=[],this._owner=e,this._that=t,this._paused=!1}function i(e,t,s,i){var n="GET",u=new XMLHttpRequest;if("withCredentials"in u)u.open(n,t,!0);else{if("undefined"==typeof XDomainRequest)throw"XHR not supported";u=new XDomainRequest,u.open(n,t)}return u.hash=s,u.key=i,u.owner=e,u.onload=this.doload,u}function n(){var e={};return this.queue=new s(this,e),this}var u=!!t.id,r={_globals:{require:u?require:!1,module:u?t:!1}},a={};s.prototype={push:function(e){this._methods.push(e),this._paused||this.flush()},unshift:function(e){this._methods.unshift(e),this._paused||this.flush()},flush:function(){var e,t=arguments;if(!this._paused)for(;this._methods[0];)if(e=this._methods.shift(),e.apply(this._that,t),e._paused){this._paused=!0;break}}};var o=function(){var e={};return{on:function(t,s){e[t]||(e[t]=[]),e[t].unshift(s)},off:function(t,s){if(e[t]){var i=e[t].indexOf(s);e[t].splice(i,1)}},emit:function(t,s){if(e[t])for(var i={type:t,detail:s,isCanceled:!1,cancelBubble:function(){this.isCanceled=!0}},n=e[t].length;n--;){if(i.isCanceled)return;e[t][n](i)}}}},h={init:function(){return this},work_handler:function(e){var t=Array.prototype.slice.call(e.data,1),s=e.data[0],i=tree[s].apply(tree,t);postMessage([s,i])},setup:function(t){var s=e.URL||e.webkitURL,i="var tree = {"+this.parse(t).join(",")+"};",n=new Blob([i+'self.addEventListener("message", '+this.work_handler.toString()+", false);"],{type:"text/javascript"}),u=new Worker(s.createObjectURL(n));return u.onmessage=function(e){var t=Array.prototype.slice.call(e.data,1),s=e.data[0];h.observer.emit("thread:"+s,t)},u},call_handler:function(e,t,s){return function(){var i=[].slice.call(arguments),n=function(t){h.observer.off("thread:"+e,n),s(t.detail[0])};i.unshift(e),h.observer.on("thread:"+e,n),t.postMessage(i)}},compile:function(e,t){var s,i=this.setup(e);for(s in e)a[s]=this.call_handler(s,i,t)},parse:function(e,t){var s,i,n,u=[];for(s in e)if(n=e[s],null!==n)if(void 0!==n){switch(n.constructor){case Date:i="new Date("+n.valueOf()+")";break;case Object:i="{"+this.parse(n).join(",")+"}";break;case Array:i="["+this.parse(n,!0).join(",")+"]";break;case String:i='"'+n.replace(/"/g,'\\"')+'"';break;case RegExp:i=n.toString(),i='new RegExp("'+i.slice(1,i.lastIndexOf("/"))+'", "'+i.slice(i.lastIndexOf("/")+1)+'")';break;case Function:i=n.toString().replace(/\bself\b/g,"this."+s);break;default:i=n}t?u.push(i):u.push(s+":"+i)}else u.push(s+":undefined");else u.push(s+":null");return u},parseFunc:function(e,t){var s,i,n=t.toString();return s=n.match(/functio.+?\((.*?)\)/)[1].split(","),i=n.match(/functio.+?\{([\s\S]*)\}/i)[1].trim(),i=i.replace(/\bself\b/g,"this."+e),i=i.replace(/\brequire\b/g,"this._globals.require"),i=i.replace(/\bmodule\b/g,"this._globals.module"),i=i.replace(/\bthis.pause\b/g,"this._globals.qure.pause"),i=i.replace(/\bthis.precede\b/g,"this._globals.qure.precede"),i=i.replace(/\bthis.then\b/g,"this._globals.qure.then"),i=i.replace(/\bthis.resume\b/g,"this._globals.qure.resume"),s.push(i),Function.apply({},s)},observer:o()};i.prototype={doload:function(e){var t,s=JSON.parse(e.target.responseText),i=[],n=!0;if(this.hash){this.hash[this.key]=s;for(t in this.hash)"string"==typeof this.hash[t]&&(n=!1);n&&i.push(this.hash._single?this.hash._single:this.hash)}this.owner.queue._paused=!1,this.owner.queue.flush.apply(this.owner.queue,i)}},n.prototype={fork:function(){return new n},wait:function(e){var t=this,s=function(){setTimeout(function(){t.queue._paused=!1,t.queue.flush()},e||0)};return s._paused=!0,this.queue.push(s),this},then:function(e){var t=this,s=function(){var s=[];r._globals.res?(s.push(r._globals.res),delete r._globals.res):s=arguments,e.apply(t.queue._that,s)};return this.queue.push(s),this},require:function(e,t,s){var n=this,u=function(){var u=new i(n,e,t,s);u.send()};if("object"==typeof e){for(var r in e)this.require(e[r],e,r);return this}return t?(u._paused=!0,this.queue.push(u),this):(this.require({_single:e}),this)},declare:function(e){var t=this,s=function(){var s,i,n={};"function"==typeof e&&(e={single_anonymous_func:e});for(s in e)i=e[s],i.constructor===Function?"Sync"===s.slice(-4)?r[s]=h.parseFunc(s,e[s]):n[s]=e[s]:r[s]=n[s]=e[s];h.compile(n,function(){t.precede(function(){t.pause(!0)}),t.resume.apply(t,arguments)})};return this.queue.push(s),this},run:function(){var e=this,t=[].slice.call(arguments),s=function(){var s=a[t[0]]||r[t[0]]?t.shift():"single_anonymous_func";r[s]?(r._globals.qure=e,r._globals.res=r[s].apply(r,t)):(e.pause(!0),a[s].apply(a,t))};return this.queue.push(s),this},precede:function(e){return this.queue.unshift(e),this},resume:function(){return this.queue._paused=!1,this.queue.flush.apply(this.queue,arguments),this},pause:function(e){var t=function(){};return t._paused=!0,e?this.queue.unshift(t):this.queue.push(t),this}},e.Qure=t.exports=new n}("undefined"!=typeof window?window:{},"undefined"!=typeof module?module:{});