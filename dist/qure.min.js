/*
 * qure.js [v0.2.11]
 * https://github.com/hbi99/QureJS.js 
 * Copyright (c) 2013-2015, Hakan Bilgin <hbi@longscript.com> 
 * Licensed under the MIT License
 */
!function(e,s){"use strict";function t(e,s){this._methods=[],this._owner=e,this._that=s,this._paused=!1}function r(e,s,t,r){var i="GET",n=new XMLHttpRequest;if("withCredentials"in n)n.open(i,s,!0);else{if("undefined"==typeof XDomainRequest)throw"XHR not supported";n=new XDomainRequest,n.open(i,s)}return n.hash=t,n.key=r,n.owner=e,n.onload=this.doload,n}function i(){var e={};return this.queue=new t(this,e),this}var n=!!s.id,u={_globals:{require:n?require:!1,module:n?s:!1}},a={};t.prototype={push:function(e){this._methods.push(e),this._paused||this.flush()},unshift:function(e){this._methods.unshift(e),this._paused||this.flush()},flush:function(){var e,s=arguments;if(!this._paused)for(;this._methods[0];)if(e=this._methods.shift(),e.apply(this._that,s),e._paused){this._paused=!0;break}}};var o={setup:function(s){var t,r,i,u=e.URL||e.webkitURL,a="var tree = {"+this.parse(s).join(",")+"};";return n?(i=function(e){var t=JSON.parse(e).data,r=t.shift(),i=s[r].apply(s,t);process.send(JSON.stringify([r,i]))},r=r=new h,a=a+'process.on("message", '+i.toString()+");",r.postMessage(a)):(i=function(e){var t=Array.prototype.slice.call(e.data,1),r=e.data[0],i=s[r].apply(s,t);postMessage([r,i])},t=new Blob([a+'self.addEventListener("message", '+i.toString()+", false);"],{type:"text/javascript"}),r=new Worker(u.createObjectURL(t))),r.onmessage=function(e){var s=Array.prototype.slice.call(e.data,1);e.data[0];this.qure.resume.apply(this.qure,s)},r},call_handler:function(e,s,t){return function(){var r=Array.prototype.slice.call(arguments);r.unshift(e),t.pause(!0),s.qure=t,s.postMessage(r)}},compile:function(e,s){var t,r=this.setup(e);for(t in e)a[t]=this.call_handler(t,r,s);a._worker=r},parse:function(e,s){var t,r,i,n=[];for(t in e)if(i=e[t],null!==i)if(void 0!==i){switch(i.constructor){case Date:r="new Date("+i.valueOf()+")";break;case Object:r="{"+this.parse(i).join(",")+"}";break;case Array:r="["+this.parse(i,!0).join(",")+"]";break;case String:r='"'+i.replace(/"/g,'\\"')+'"';break;case RegExp:r=i.toString(),r='new RegExp("'+r.slice(1,r.lastIndexOf("/"))+'", "'+r.slice(r.lastIndexOf("/")+1)+'")';break;case Function:r=i.toString().replace(/\bself\b/g,"this."+t);break;default:r=i}s?n.push(r):n.push(t+":"+r)}else n.push(t+":undefined");else n.push(t+":null");return n},parseFunc:function(e,s){var t,r,i=s.toString();return t=i.match(/functio.+?\((.*?)\)/)[1].split(","),r=i.match(/functio.+?\{([\s\S]*)\}/i)[1].trim(),r=r.replace(/\bself\b/g,"this."+e),r=r.replace(/\brequire\b/g,"this._globals.require"),r=r.replace(/\bmodule\b/g,"this._globals.module"),r=r.replace(/\bthis.pause\b/g,"this._globals.qure.pause"),r=r.replace(/\bthis.precede\b/g,"this._globals.qure.precede"),r=r.replace(/\bthis.then\b/g,"this._globals.qure.then"),r=r.replace(/\bthis.resume\b/g,"this._globals.qure.resume"),t.push(r),Function.apply({},t)}};if(r.prototype={doload:function(e){var s,t=JSON.parse(e.target.responseText),r=[],i=!0;if(this.hash){this.hash[this.key]=t;for(s in this.hash)"string"==typeof this.hash[s]&&(i=!1);i&&r.push(this.hash._single?this.hash._single:this.hash)}this.owner.queue._paused=!1,this.owner.queue.flush.apply(this.owner.queue,r)}},i.prototype={fork:function(){return new i},wait:function(e){var s=this,t=function(){setTimeout(function(){s.queue._paused=!1,s.queue.flush()},e||0)};return t._paused=!0,this.queue.push(t),this},then:function(e){var s=this,t=function(){var t=[];u._globals.res?(t.push(u._globals.res),delete u._globals.res):t=arguments,e.apply(s.queue._that,t),s.queue._methods.length||a._worker.process.kill()};return this.queue.push(t),this},require:function(e,s,t){var i=this,n=function(){var n=new r(i,e,s,t);n.send()};if("object"==typeof e){for(var u in e)this.require(e[u],e,u);return this}return s?(n._paused=!0,this.queue.push(n),this):(this.require({_single:e}),this)},declare:function(e){var s=this,t=function(){var t,r,i={};"function"==typeof e&&(e={single_anonymous_func:e});for(t in e)r=e[t],r.constructor===Function?"Sync"===t.slice(-4)?u[t]=o.parseFunc(t,e[t]):i[t]=e[t]:u[t]=i[t]=e[t];o.compile(i,s)};return this.queue.push(t),this},run:function(){var e=this,s=Array.prototype.slice.call(arguments),t=function(){var t=a[s[0]]||u[s[0]]?s.shift():"single_anonymous_func";u[t]?(u._globals.qure=e,u._globals.res=u[t].apply(u,s)):(e.pause(!0),a[t].apply(a,s))};return this.queue.push(t),this},precede:function(e){return this.queue.unshift(e),this},resume:function(){return this.queue._paused=!1,this.queue.flush.apply(this.queue,arguments),this},pause:function(e){var s=function(){};return s._paused=!0,e?this.queue.unshift(s):this.queue.push(s),this}},n){var h=function(){var e=this,s=require("child_process");this.process=s.fork(__dirname+"/eval"),this.process.on("message",function(s){e.terminate(),e.onmessage&&e.onmessage({data:JSON.parse(s)})}),this.process.on("error",function(s){e.onerror&&e.onerror(s)})};h.prototype={onmessage:null,onerror:null,postMessage:function(e){this.process.send(JSON.stringify({data:e}))},terminate:function(){}}}e.Qure=s.exports=new i}("undefined"!=typeof window?window:{},"undefined"!=typeof module?module:{});